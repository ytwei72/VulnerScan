package com.dky.vulnerscan.module;

import org.springframework.web.context.ContextLoader;
import org.springframework.web.context.WebApplicationContext;

/**
 * Created by bo on 2016/12/27.
 */
public class ExploitScanThread extends Thread {
    private int projectID;
    private int taskID;
    private String ip;
    private String vulName;
    private WebApplicationContext context = ContextLoader.getCurrentWebApplicationContext();
    private ExploitScanModule exploitScanModule = (ExploitScanModule) context.getBean("ExploitScanModule");

    public ExploitScanThread(int projectID, int taskID, String ip, String vulName) {
        this.projectID = projectID;
        this.taskID = taskID;
        this.ip = ip;
        this.vulName = vulName;
    }

    @Override
    public void run() {
        exploitScanModule.handResult(projectID,taskID,ip,vulName);
    }
}
